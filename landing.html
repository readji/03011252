<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ëœë”©í˜ì´ì§€</title>
</head>
<body>
    <h1>ëœë”©í˜ì´ì§€</h1>
    <img id="landingImage" src="" alt="ëœë”©í˜ì´ì§€ ì´ë¯¸ì§€" width="300"><br>
    
    <form id="landingForm">
        <input type="text" id="name" placeholder="ì´ë¦„ ì…ë ¥"><br>
        <input type="email" id="email" placeholder="ì´ë©”ì¼ ì…ë ¥"><br>
        <input type="text" id="phone" placeholder="ì „í™”ë²ˆí˜¸ ì…ë ¥"><br>
        <button type="button" onclick="submitData()">ì œì¶œ</button>
    </form>

    <script>
        function loadLandingPage() {
            const params = new URLSearchParams(window.location.search);
            const imageUrl = params.get("image");
            const nameCheck = params.get("name") === "true";
            const emailCheck = params.get("email") === "true";
            const phoneCheck = params.get("phone") === "true";

            // ğŸ¯ ë§Œì•½ URLì—ì„œ ì´ë¯¸ì§€ ì£¼ì†Œë¥¼ ëª» ê°€ì ¸ì˜¤ë©´ ì˜¤ë¥˜ ë©”ì‹œì§€ í‘œì‹œ
            if (!imageUrl) {
                document.body.innerHTML = "<h1>ì¡´ì¬í•˜ì§€ ì•ŠëŠ” ëœë”©í˜ì´ì§€ì…ë‹ˆë‹¤.</h1>";
                return;
            }

            document.getElementById("landingImage").src = decodeURIComponent(imageUrl);

            if (!nameCheck) document.getElementById("name").style.display = "none";
            if (!emailCheck) document.getElementById("email").style.display = "none";
            if (!phoneCheck) document.getElementById("phone").style.display = "none";
        }

        function submitData() {
            const params = new URLSearchParams(window.location.search);
            const id = params.get("id");

            const name = document.getElementById("name").value;
            const email = document.getElementById("email").value;
            const phone = document.getElementById("phone").value;

            const entry = { name, email, phone };

            const dbData = JSON.parse(localStorage.getItem(`db_${id}`)) || [];
            dbData.push(entry);
            localStorage.setItem(`db_${id}`, JSON.stringify(dbData));

            alert("ì œì¶œë˜ì—ˆìŠµë‹ˆë‹¤!");
        }

        window.onload = loadLandingPage;
    </script>
</body>
</html>
